{# Template for generating an association table for object array relationships #}

{{ table_name }} = Table(
    "{{ table_name }}",
    OcsfBase.metadata,
    Column("id", Integer, primary_key=True),
    Column(
        "{{ parent_fk_name }}",
        Integer,
        ForeignKey("{{ parent_table }}.id", ondelete="CASCADE"),
        nullable=False,
        index=True,
    ),
    Column(
        "{{ child_fk_name }}",
        Integer,
        ForeignKey("{{ child_table }}.id", ondelete="CASCADE"),
        nullable=False,
        index=True,
    ),
    Column("position", Integer, nullable=True, comment="Order in the array"),
{% if additional_columns %}
{% for col in additional_columns %}
    Column("{{ col.name }}", {{ col.type }}, nullable={{ col.nullable }}),
{% endfor %}
{% endif %}
    comment="{{ description | default('Association table for ' + parent_entity + '.' + attribute_name) }}",
)
